\documentclass{beamer}

\usepackage{amsmath,amssymb}
\usepackage{graphicx}

\author{Presenter: Tzu-Yu Jeng \\ Advisor: Prof. Hsuan-Jung Su}
\date{\today}
\title{Precoding Design by Simulated Annealing}
\begin{document}
\maketitle

% % % % % % % % % % % %

\begin{frame}
	\frametitle{Outline}
	\begin{itemize}
\item Motivation
\item Problem Setting
\item Algorithm Description
\item Convergence Results
\item Simulation
\item Future Work
\item References
	\end{itemize}
\end{frame}

% % % % % % % % % % % %


\begin{frame}
	\frametitle{Motivation}
	\begin{itemize}
	\item Massive MIMO is expected to improve spectral efficiency, but hardware overhead due to large number of antennas increases complexity and power consumption
	\item We may want devise feasible simulation method to deal with increasingly complicated systems
	\item Metaheuristic algorithms, like simulated annealing
(SA), might provide a sufficiently good solution to the optimization problem with incomplete knowledge or limited computation power
	\item We present a problem setting with shared precoders of a large number of users and subcarriers with SA
	\item Certain convergence results of SA has been claimed, but much remains to be investigated
	\end{itemize}
\end{frame}



% % % % % % % % % % % %

\begin{frame}
	\frametitle{Problem Setting (1/3)}
	\begin{itemize}
	\item \(R(u,k) =\log(1 +I(u,k))\)
	\item \(I(u,k) =\dfrac{\phi(u,k)}{1 +\Phi(k) -\phi(u,k)}\)

	\item \(\Phi(k) =\sum_{u=1}^U \phi(u,k)\)
	\item \(\phi(u,k) =\|H_{\mathrm{eff}}(u,k)\|_F^2\)
	\item \(F =F(u,k) =F(u_f(u), k_f(k))\)
	\item \(H_{\mathrm{eff}}(u,k) =H(k) F(k_f(k),u_f(u))\)
	\item where \(u =1,\dotsc,U\), \(k =1,\dotsc,K\), \(u_f =1,\dotsc,U_f\), \(k_f =1,\dotsc,K_f\), with
	\begin{gather*}
    k_f(k) =\lceil k/b_k \rceil \\
    u_f(u) =\lceil u/b_u \rceil
	\end{gather*}
	\end{itemize}
	
\end{frame}

% % % % % % % % % % % %

\begin{frame}
	\frametitle{Problem Setting (2/3)}
	\begin{itemize}
\item The channel model \(H(k)\)
	\begin{gather*}
H(k) =\sum_{n_c=1}^{N_c} \sum_{n_s=1}^{N_s} \alpha(n_c,n_s) a(\theta_r(n_c,n_s)) a(\theta_t(n_c,n_s))^\dagger \\
a(\theta') =\langle 1, e^{i \theta'}, \dotsc e^{i (N-1) \theta'} \rangle
	\end{gather*}
	are random instances of \(\theta_r, \theta_t\).
	\item \(k =1,\dotsc,K\) for subcarriers, \(n_c =1,\dotsc,N_c\) for clusters, \(n_s =1,\dotsc,N_s\) for scatterers.
	\end{itemize}
\end{frame}

% % % % % % % % % % % %

\begin{frame}
	\frametitle{Problem Setting (3/3)}
	\begin{itemize}
	\item The main problem reads now
	\begin{gather*}
\min_{F(k_f,u_f)} L \\
L =\sum_{k=1}^K \sum_{u=1}^U R(u,k) \\
\|F(u_f,k_f)\|_F \leq P
	\end{gather*}
	\end{itemize}
\end{frame}

% % % % % % % % % % % %

\begin{frame}
	\frametitle{Target Distribution}
	\begin{itemize}
	\item Let \(S \in \mathbb{R}^d\) be a compact set with its boundary having Lebesgue measure 0.
	Let \(\mathcal{B}\) be the Borel \(\sigma\)-field on \(S\).
	And let strictly positive, continuous \(g\) be given as probability density.
	\item \textbf{Definition}. A target distribution \(\pi\) satisfies
	\begin{gather*}
	\pi(A)
	=\int_A g(x) dx,
	\quad \forall A \in \mathcal{B}
	\end{gather*}
	\end{itemize}
\end{frame}

% % % % % % % % % % % %

\begin{frame}
	\frametitle{Acceptance Probability Function}
	\begin{itemize}
	\item \textbf{Definition}. Let \(\beta\) be a function on \(S^2\) so that
	\item \(0 <\delta \leq \beta(x,y) \leq 1\) for some \(\delta >0\)
	\item \(\beta(x,y)\) is jointly measurable on \(S^2\)
	\item \(\beta(x,y) g(x) =\beta(y,x) g(y)\), \(\forall x,y \in S\).
	\end{itemize}
\end{frame}

% % % % % % % % % % % %

\begin{frame}
	\frametitle{A General Random Walk Algorithm}
	\begin{enumerate}
    \item Choose a starting point \(x_0\)	in the interior of \(S\)
    \item \(t \leftarrow 0\)
    \item Choose randomly a unit vector \(\theta_t\) on the unit sphere
    \item Choose randomly a length \(\lambda_t >0\)
    \item \(x' \leftarrow x +\theta_t \lambda_t\)
    \item If \(x' \in S\), assign \(x \leftarrow x'\) with probability \(\beta(x,x')\)
    \item \(t \leftarrow t+1\)
	\end{enumerate}
\end{frame}

% % % % % % % % % % % %

\begin{frame}
	\frametitle{Markov Kernel}
	\begin{itemize}
	\item \textbf{Definition}. A Markov kernel on \((S,\mathcal{B})\) is a nonnegative function \(P\) defined on \((S \times \mathcal{B})\) such that
	\item (i) \(\forall x \in S\), \(P(x, \cdot)\) is a probability measure on \(\mathcal{B}\)
	\item (ii) \(\forall A \in \mathcal{B}\), \(P(\cdot, A)\) is a measurable function of \(S\) 
	\end{itemize}
\end{frame}

% % % % % % % % % % % %

\begin{frame}
	\frametitle{Reversibility}
	\begin{itemize}
	\item \textbf{Definition}. A Markov kernel \(P\) is reversible if
	\begin{gather*}
	\int_A P(x,B) \pi(dx)
	=\int_B P(x,A) \pi(dx)
	\quad A,B \in \mathcal{B}
	\end{gather*}
	\end{itemize}
\end{frame}

% % % % % % % % % % % %

\begin{frame}
	\frametitle{A Reversible Markov Kernel}
	\begin{itemize}
	\item \textbf{Lemma 1}. The following Markov kernel \(P\) is reversible:
	\begin{gather*}
    P(x,A)
    =\int_A p(x,y) \pi(dy)
    +\mathbf{1}_A(x) \left( 1 -\int_S p(x,y) \pi(dy) \right)
	\end{gather*}
	where \(\mathbf{1}\) is the indicator function, for any \(p\) satisfying \(p(x,y) =p(y,x)\).

	\item \textbf{Lemma 2}. Suppose that a Markov kernel \(P\) is reversible w.r.t.\ a probability measure \(\pi\), then \(\pi\) is a stationary distribution for \(P\).
	\end{itemize}
\end{frame}

% % % % % % % % % % % %

\begin{frame}
	\frametitle{Markov Kernel of Random Walk}
	\begin{itemize}
	\item \textbf{Proposition 3}. For the random walk algorithm just introduced, the Markov kernel is given by the expression in Lemma 1, where
	\begin{gather*}
	p(x,y)
	=\beta(x,y) \frac {h\left( \frac{y-x}{|x-y|} \right) +h\left( \frac{x-y}{|x-y|} \right) } {(\partial D) \cdot \mathrm{diam}(S) g(y)}
	\end{gather*}
	for some \(h\), \(\partial D\) the surface area of unit ball, \(\mathrm{diam}(S)\) the diameter of \(S\), \(g(y)\) the probability density of \(\pi\).
	\end{itemize}
\end{frame}

% % % % % % % % % % % %

\begin{frame}
	\frametitle{Random Walk Converges}
	\begin{itemize}
	\item \textbf{Proposition 4}. The Markov kernel \(P\) described in Proposition 3 is reversible, and corresponding \(\pi\) is stationary.
	
	\item \textbf{Proposition 5}. Continue the configuration in random walk algorithm.
	Starting from \(\forall X_0 =x_0 \in S\), let the Markov chain \(X_n\), \(n=0,1,2,\dotsc\) be determined.
	Then,
	\begin{gather*}
	\lim_{n \to \infty} \mathcal{P}(X_n \in B)
	=\pi(B),
	\quad \forall B \in \mathcal{B}
	\end{gather*}
	\end{itemize}
\end{frame}

% % % % % % % % % % % %

\begin{frame}
	\frametitle{Simulation Setting (1/2)}
	\begin{itemize}
	\item Number of antennae \(N =7\)
	\item Number of subcarriers \(K =4\), where \(b_k =2\) subcarriers share a precoder
	\item Number of users \(U =6\), where \(b_u =2\) users share a precoder
	\item Number of clusters \(N_c =6\), number of scatterers \(N_s =6\)
	\item Maximum power (Frobenious norm of precoders) \(P =10^6\)
	\item Record every 100 time indices, initial temperature \(T=1\), change temperature \(T \leftarrow r_T T\) every 10 time indices
	\end{itemize}
\end{frame}

% % % % % % % % % % % %

\begin{frame}
	\frametitle{Simulation Setting (2/2)}
	\begin{itemize}
	\item For probability
	\begin{gather*}	
	e^{-(L'-L)/T}
	\end{gather*}
	a candidate \(F'\) in the neighborhood is accepted so that \(F \leftarrow F'\)
	\item To account for power constraint, we multiply to the sum rate a punishment
	\begin{gather*}
	\frac{1}{\prod_{k_f} \prod_{u_f} \left( 1 +e^{ (P-\|H(u,k) F'(u,k)\|_F)^2} \right) }
	\end{gather*}
	\end{itemize}
\end{frame}

% % % % % % % % % % % %

\begin{frame}
	\frametitle{Simulation: \(N=4\)}
	Temperature changing ratio \(r_T =0.99, 0.98, 0.97, 0.96\) (resp., red, green, cyan, blue)
	\begin{center}
	\includegraphics[scale=0.60]{n_4.png}
	\end{center}
\end{frame}

\begin{frame}
	\frametitle{Simulation: \(N=5\)}
	Temperature changing ratio \(r_T =0.99, 0.98, 0.97, 0.96\)
	\begin{center}
	\includegraphics[scale=0.60]{n_5.png}
	\end{center}
\end{frame}


\begin{frame}
	\frametitle{Simulation: \(N=7\)}
	Temperature changing ratio \(r_T =0.99, 0.98, 0.97, 0.96\)
	\begin{center}
	\includegraphics[scale=0.60]{n_7.png}
	\end{center}
\end{frame}

% % % % % % % % % % % %

\begin{frame}
	\frametitle{Difficulty and Future Work}
	\begin{itemize}
\item Study effective parameters for SA
\item Implement other beamforming algorithms too
\item Accounting for discrete precoders set
\item Generalization to hybrid beamforming
\item Description of neighborhood of linear operator
\item Operations regarding linear operator
\item Explicit generalization of the SA convergence proof to present problem of beamforming
\item A more rigorous, statistical-mechanics interpretation of SA proof
	\end{itemize}
\end{frame}

% % % % % % % % % % % %

\begin{frame}
\frametitle{References}
\begin{enumerate}
\scriptsize {

\item C J P B\'elisle, ``Convergence Theorems for a Class of Simulated Annealing Algorithms on \(\mathbb{R}^d\)''. \textit{Journal of Applied Probability}, Vol.\ 29, No.\ 4 , pp. 885-895, Dec 1992

\item C J P B\'elisle, H E Romeijn, and R L Smith, ``Hit-and-Run Algorithms for Generating Multivariate Distributions''. \textit{Mathematics of Operations Research}, Vol.\ 18, No.\ 2, pp.\ 255-266, May 1993.

\item S Boyd, L Vandenberghe (2004), \textit{Convex Optimization}. Cambridge U. Press.

\item R W Heath Jr, N Gonz√°lez-Prelcic, S Rangan, W Roh, and A M Sayeed (2016), ``An Overview of Signal Processing Techniques for Millimeter Wave MIMO Systems''. \textit{IEEE Journal of Selected Topics in Signal Processing}, Vol.10, No.3

\item H E Romeijn and R L Smith, ``Simulated Annealing for Constrained Global Optimization''. \textit{Journal of Global Optimization}, Vol.\ 5, pp.\ 101-126, 1994.

\item F Sohrabi and W Yu, ``Hybrid Digital and Analog Beamforming Design for Large-Scale Antenna Arrays'', \textit{IEEE Journal of Selected Topics in Signal Processing}, Vol. 10, No. 3, April 2016.

\item F Sohrabi and W Yu, ``Hybrid Analog and Digital Beamforming for OFDM-Based Large-Scale MIMO Systems''. 2016 IEEE 17th International Workshop on Signal Processing Advances in Wireless Communications (SPAWC).

}

\end{enumerate}
\end{frame}

\end{document}

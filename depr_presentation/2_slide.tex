\Frame {Channel Model}
{
\I Consider uniform linear array
\Disp {
\NC \V {a} \SB {\psi'}
= \NC \F {1}{\R {N_H}} \sum_{n=0}^{N-1} \Ss {e}^{n \psi' \Ss {i}} \V {u}_n
\in \MB {V}_\MB {C} \SB {N_H} \NR
}

\I Consider the virtual representation of the MIMO channel, where \m {L} is the number of paths, \m {\f_l} the angle of arrival, \m {\th_l} the angle of arrival:
\Disp {
\NC \M{H}
=\NC \sum_{l=0} ^{L-1}
\a_l
\V {a} \SB { \F {d_{\Rm {arr}}} {\l _{\Rm {arr}} \sin \f_l }}
\V {a} \SB { \F {d_{\Rm {arr}}} {\l _{\Rm {arr}} \sin \th_l }}^\Adj
\in \MB {M}_\MB {C} \SB {N_H, N_H} \NR
}
}
% % % % % % % % % % % % % % % % % % % % % % % % % %
\Frame {Precoders and Combiners}
{
\I Tx: Digital precoder \m {\M {F}_B \in \NC \MB {M}_{\MB {C}} \SB {N_R, N_Y}}

\I Tx: Analog precoder \m {\NC \M {F}_R \in \NC \MB {M}_{\MB {C}} \SB {N_H, N_R}}

\I Rx: Digital combiner \m {\M {W}_R \in \NC \MB {M}_{\MB {C}} \SB {N_R, N_H}}

\I Rx: Analog combiner \m {\M {W}_B \in \NC \MB {M}_{\MB {C}} \SB {N_Y, N_R}}

\I With the unity magnitude constraint
\Disp {
\NC \Nm {\M {F}_R \DB {n_H, n_R}}
= \NC 1, \NR
\NC \Nm {\M {W}_R \DB {n_R, n_H}}
= \NC 1, \NR
}

\I With the assumption \m {N_H \gg N_R \gg N_Y}
}
% % % % % % % % % % % % % % % % % % % % % % % % % %
\Frame {Effective Channel}
{
\I Consider zero-mean, unity-variance additive white Gaussian noise (AWGN) \m {\M{Z}}

\I Introduce the effective channel
\Disp{
\NC \M{Y}
:=\M{W}_B \M{W}_R \RB {\M{H} \M{F}_R \M{F}_B +\M{Z}} \NR
}

\I Problem: (a) Recovering \m {\M {H}} with knowledge of \m {\M {H}}?

\I Problem: (b) Designing \m {\M {W}_R}, \m {\M {W}_B}, \m {\M {F}_R}, and \m {\M {F}_B}?
}
% % % % % % % % % % % % % % % % % % % % % % % % % %
\Frame {Working in the Angular Domain}
{
\I Set \m {N_h :=N_H^2,\; N_y :=N_Y^2}

\I Introduce the DFT matrix \m {\M {K}}
\Disp {
\NC \M {K} \in  \NC \MB {M}_{\MB {C}} \SB {N_H, N_H} \NR
\NC \M {K} \DB {n_1, n_2}
= \NC \F {1} {\R {N_H}} \Ss {e}^{2\pi \Ss{i} n_1 n_2 /N_H}, \NR
}

\I Write \m {\M {G} =\NC \M {K}^\Adj \M {H} \M {K}}
}
% % % % % % % % % % % % % % % % % % % % % % % % % %
\Frame {Vectorization}
{
\I Set \m {N_h =N_H^2,\; N_y =N_Y^2}

\I Introduce
\Disp {
\NC \V {y} := \NC \Rm {vec} \SB {\M {Y}} \NR
\NC \M {P} := \NC \RB {\M {F}_B^\Tr \M {F}_R^\Tr \M{K}^\ast} \otimes \RB {\M {W}_B \M {W}_R \M {K}} \NR
\NC \V {g} := \NC \Rm {vec} \SB {\M {G}} \NR
\NC \V {z} := \NC \Rm {vec} \SB {\M {Z}} \NR
}

\I Then we have a vector equation
\Disp {
\NC \V {y}
=\NC \M {P} \V {g} +\V {z} \NR
}
}
% % % % % % % % % % % % % % % % % % % % % % % % % %
\Frame {Proposed Method}
{
\I Input \m{\M {P} \in \MB {M}_{\MB {C}} \SB {N_y, N_h}}, \m{\V {y} \in \MB {V}_{\MB {C}} \SB {N_h}}, \m{\g \geq 0}.

\I Calculate
\Disp {
\NC \Hat {\V {g}}
\LA \NC \startcases
\NC \Min {\V {g}' \in \MB {V}_{\MB {C}} \SB {N_h}}  \MC \VNm {\V {g}'} _1 \NR
\NC \Rm {subject} \; \Rm {to} \Q \MC \VNm {\M {P}^\Adj \RB {\V {y} -\M {P} \V {g}'}} _\infty \leq \g \NR
\stopcases \NR
}

\I Convert \m {\Hat {G} \LA \Rm {vec}^{-1} \SB {\Hat {g}}}

\I Recover \m {\Hat {\M {H}} \LA \M {K} \Hat {\M {G}} \M {K}^\Adj}

\I Output \m {\Hat {\M {H}}}
}
% % % % % % % % % % % % % % % % % % % % % % % % % %

